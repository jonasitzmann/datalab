<HTML>
<HEAD>
<TITLE>REFERENCE FORWARD MODEL (RFM)</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="./sum/rfm.css">
</HEAD>
<BODY>
<H1 CLASS=BAR>REFERENCE FORWARD MODEL</H1>
<UL>
<LI><a href=#introduction>Introduction</a>
<LI><a href=#can>Things the RFM can handle</a>
<LI><a href=#cant>Things the RFM cannot handle</a>
<LI><a href=#todo>Things I'm thinking about</a>
<LI><a href=#gaslist>Recognised molecules</a>
</ul>
<h2>Local Pages</h2>
<UL>
<li><A HREF=./sum/>Software User's Manual (SUM)<img src=changed.gif></a> 
([<a href=./old/sum.html>Old Version</a>])
<li><A HREF=rfm_bugs.html>List of known bugs</a> 
<li><A HREF=rfm_upgrades.html>List of updates</a> 
<li><a href=rfm_downloads.html>Downloads</a> 
</ul>

<h6>01SEP05 AD Redesigned User's Manual</H6>
<HR>

<a name=introduction>
<h2 CLASS=BAR>Introduction</h2>
The RFM is a GENLN2-based line-by-line radiative transfer model originally
developed at 
<a href=http://www-atm.atm.ox.ac.uk/>AOPP</a>, 
Oxford University,
under an ESA contract to provide 
reference spectral calculations for the 
<A href=http://envisat.estec.esa.nl/instruments/mipas/index.html>MIPAS</a> 
launched on the 
<a href=http://envisat.estec.esa.nl/>ENVISAT</a> satellite in 2002.
<p>
It has subsequently developed into a general purpose code suitable for a 
variety of different 
spectroscopic calculations. The main design features are
<ul>
<li> Easy to use - probably its main advantage
<li> Robustness - you <i>shouldn't</i> be able to crash the program
<li> Portability - written in (almost) standard FORTRAN-77
<li> Efficient coding - attempts to maximise speed while minimising memory
<li> Self-documented code - just in case you need to make you own modifications
<li> On-line documentation - these web pages
<LI> Output spectra independent of spectral range 
(eg value at 901.3 cm-1 will be the same whether you produce a spectrum from
901.2-901.4 cm-1 or from 500-1000 cm-1)
</ul>
I'll consider adding other features that people would find useful, including
combinations of features which are currently not allowed. Just let me know,
along with any <a href=rfm_bugs.html>bug-reports</a>.
<P>
To get a copy, email me with a brief statement on what you're planning on
using it for and I'll email you the source code.
<p>
Anu Dudhia ( <a href=mailto:dudhia@atm.ox.ac.uk>dudhia@atm.ox.ac.uk</a> ) 

<a name=can>
<h2 class=bar>Things the RFM can handle... </h2>
(Not all of these are compatible - 
see <a href=./sum/rfm_flags.html>User's Manual</a> for the full
list of 'flags').
<ul> 
<li> Spherical or plane-parallel atmospheres, or homogeneous paths
<li> Field-of-View  & Instrument Line Shape convolutions
<li> CO2 Line mixing
<li> Continua for H2O, O2, N2 and CO2
<li> Non-LTE (via user-supplied vibrational temperatures)
<li> Select lines of particular isotopes and/or bands
<li> Jacobians (Weighting functions) for p, T, VMR, 
line-of-sight pointing and 
surface temperature and emissitivity
<li> Satellite/Balloon & Aircraft/Ground-based viewing geometries
<li> Surface reflections
<li> Output spectra of radiance, transmittance, absorption, 
cooling rates, optical depth and/or brightness temperature
<li> Output diagnostics from ray-tracing (including Curtis-Godson integrations)
<li> Output/Input absorption coefficient tabulations k(nu,p,T)
<li> Horizontal structure in the atmosphere
<li> Flux calculations and matrices.
<li> Different isotopic mixing ratio profiles 
</ul>

<a name=cant>
<h2 class=bar>Things the RFM can't handle...</h2>
<ul>
<li> Scattering (too difficult)
<li> Instrument Line Shapes wider than around 1cm-1 (best done by the user
afterwards) 
</ul>

<a name=todo>
<h2 class=bar>Things I'm thinking about ... </h2>
<ul>
<LI> Making the RFM (and hitbin) compatible with the new HITRAN 2004 format
<li> Rewriting the code in Fortran 90 (mainly for the dynamic array sizing)
<li> Putting source code and sample input files on an ftp site
(see <a href=rfm_downloads.html>RFM Downloads</a>)
<li> Setting up a users' e-mail list
<li> Option to read HITRAN ASCII files directly
<li> Rodrigues et al CO2 line-mixing (JQSRT 16, 153)
</ul>

 

<a name=gaslist>
<h2 class=bar>Recognised Molecules</h2>
The following is a list of all the molecules recognised by the RFM.

<TABLE ALIGN=CENTER>
<TR>
    <TH> ID <TH> Molecule <TH>
    <TH> ID <TH> Molecule <TH>
    <TH> ID <TH> Molecule <TH>
    <TH> ID <TH> Molecule <TH>
    <TH> ID <TH> Molecule 
<TR>
    <TD ALIGN=RIGHT> 1 <TD ALIGN=CENTER><FONT COLOR=RED><TT> H2O <TD>
    <TD ALIGN=RIGHT> 2 <TD ALIGN=CENTER><FONT COLOR=RED><TT> CO2 <TD>
    <TD ALIGN=RIGHT> 3 <TD ALIGN=CENTER><FONT COLOR=RED><TT> O3 <TD>
    <TD ALIGN=RIGHT> 4 <TD ALIGN=CENTER><FONT COLOR=RED><TT> N2O <TD>
    <TD ALIGN=RIGHT> 5 <TD ALIGN=CENTER><FONT COLOR=RED><TT> CO 
<TR>
    <TD ALIGN=RIGHT> 6 <TD ALIGN=CENTER><FONT COLOR=RED><TT> CH4 <TD>
    <TD ALIGN=RIGHT> 7 <TD ALIGN=CENTER><FONT COLOR=RED><TT> O2 <TD>
    <TD ALIGN=RIGHT> 8 <TD ALIGN=CENTER><FONT COLOR=RED><TT> NO <TD>
    <TD ALIGN=RIGHT> 9 <TD ALIGN=CENTER><FONT COLOR=RED><TT> SO2 <TD>
    <TD ALIGN=RIGHT>10 <TD ALIGN=CENTER><FONT COLOR=RED><TT> NO2 
<TR>
    <TD ALIGN=RIGHT> 11 <TD ALIGN=CENTER><FONT COLOR=RED><TT> NH3 <TD>
    <TD ALIGN=RIGHT> 12 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HNO3 <TD>
    <TD ALIGN=RIGHT> 13 <TD ALIGN=CENTER><FONT COLOR=RED><TT> OH <TD>
    <TD ALIGN=RIGHT> 14 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HF <TD>
    <TD ALIGN=RIGHT> 15 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HCl 
<TR>
    <TD ALIGN=RIGHT> 16 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HBr <TD>
    <TD ALIGN=RIGHT> 17 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HI <TD>
    <TD ALIGN=RIGHT> 18 <TD ALIGN=CENTER><FONT COLOR=RED><TT> ClO <TD>
    <TD ALIGN=RIGHT> 19 <TD ALIGN=CENTER><FONT COLOR=RED><TT> OCS <TD>
    <TD ALIGN=RIGHT> 20 <TD ALIGN=CENTER><FONT COLOR=RED><TT> H2CO 
<TR>
    <TD ALIGN=RIGHT> 21 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HOCl <TD>
    <TD ALIGN=RIGHT> 22 <TD ALIGN=CENTER><FONT COLOR=RED><TT> N2 <TD>
    <TD ALIGN=RIGHT> 23 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HCN <TD>
    <TD ALIGN=RIGHT> 24 <TD ALIGN=CENTER><FONT COLOR=RED><TT> CH3Cl <TD>
    <TD ALIGN=RIGHT> 25 <TD ALIGN=CENTER><FONT COLOR=RED><TT> H2O2
<TR>
    <TD ALIGN=RIGHT> 26 <TD ALIGN=CENTER><FONT COLOR=RED><TT> C2H2 <TD>
    <TD ALIGN=RIGHT> 27 <TD ALIGN=CENTER><FONT COLOR=RED><TT> C2H6 <TD>
    <TD ALIGN=RIGHT> 28 <TD ALIGN=CENTER><FONT COLOR=RED><TT> PH3 <TD>
    <TD ALIGN=RIGHT> 29 <TD ALIGN=CENTER><FONT COLOR=RED><TT> COF2 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffffaa> 30 <TD ALIGN=CENTER BGCOLOR=#ffffaa>
                                         <FONT COLOR=RED><TT> SF6q 
<TR>
    <TD ALIGN=RIGHT> 31 <TD ALIGN=CENTER><FONT COLOR=RED><TT> H2S <TD>
    <TD ALIGN=RIGHT> 32 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HCOOH <TD>
    <TD ALIGN=RIGHT> 33 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HO2 <TD>
    <TD ALIGN=RIGHT> 34 <TD ALIGN=CENTER><FONT COLOR=RED><TT> O <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffffaa> 35 <TD ALIGN=CENTER BGCOLOR=#ffffaa>
                                         <FONT COLOR=RED><TT> ClONO2q
<TR>
    <TD ALIGN=RIGHT> 36 <TD ALIGN=CENTER><FONT COLOR=RED><TT> NO+ <TD>
    <TD ALIGN=RIGHT> 37 <TD ALIGN=CENTER><FONT COLOR=RED><TT> HOBr <TD>
    <TD ALIGN=RIGHT> 38 <TD ALIGN=CENTER><FONT COLOR=RED><TT> C2H4 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 39 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> HDO <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 40 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> BrO
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 41 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> C3H8 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 42 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> C2N2 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 43 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> C4H2 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 44 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> HC3N <TD>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 45 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> C3H4 
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#ffbbbb> 46 <TD ALIGN=CENTER BGCOLOR=#ffbbbb>
                                         <FONT COLOR=RED><TT> GeH4 <TD>
    <TD ALIGN=RIGHT> 47 <TD ALIGN=CENTER> [unassigned] <TD>
    <TD ALIGN=RIGHT> 48 <TD ALIGN=CENTER> [unassigned] <TD>
    <TD ALIGN=RIGHT> 49 <TD ALIGN=CENTER> [unassigned] <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffff> 50 <TD ALIGN=CENTER BGCOLOR=#bbffff>
                                         <FONT COLOR=RED><TT> Aerosol
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 51 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
                                         <FONT COLOR=RED><TT> F11 (CFCl3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 52 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
                                         <FONT COLOR=RED><TT> F12 (CF2CL2) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 53 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
                                         <FONT COLOR=RED><TT> F13 (CClF3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 54 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
                                         <FONT COLOR=RED><TT> F14 (CF4) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 55 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
                                         <FONT COLOR=RED><TT> F21 (CHCl2F) 
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 56 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F22 (CHClF2) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 57 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F113 (C2Cl3F3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 58 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F114 (C2Cl2F4) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 59 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F115 (C2ClF5) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 60 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> CCl4
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 61 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> ClONO2 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 62 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> N2O5 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 63 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> HNO4 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 64 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> SF6 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbbbff> 65 <TD ALIGN=CENTER BGCOLOR=#bbbbff>
         <FONT COLOR=RED><TT> X65 <TD>
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbbbff> 66 <TD ALIGN=CENTER BGCOLOR=#bbbbff>
         <FONT COLOR=RED><TT> X66 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbbbff> 67 <TD ALIGN=CENTER BGCOLOR=#bbbbff>
         <FONT COLOR=RED><TT> X67 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbbbff> 68 <TD ALIGN=CENTER BGCOLOR=#bbbbff>
         <FONT COLOR=RED><TT> X68 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbbbff> 69 <TD ALIGN=CENTER BGCOLOR=#bbbbff>
         <FONT COLOR=RED><TT> X69 <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 70 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F123 </TT></FONT> (CHCl2CF3) 
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 71 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F124 </TT></FONT> (CHClFCF3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 72 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F141b </TT></FONT> (CH3CCl2F) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 73 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F142b </TT></FONT> (CH3CClF2) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 74 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F225ca </TT></FONT> (CHCl2CF2CF3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 75 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F225cb </TT></FONT> (CClF2CF2CHClF) 
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 76 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F32 (CH2F2) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 77 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F125 (CHF2CF3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 78 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F134 </TT></FONT> (CHF2CHF2) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 79 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F134a (CFH2CF3) <TD>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 80 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F143a (CF3CH3) 
<TR>
    <TD ALIGN=RIGHT BGCOLOR=#bbffbb> 81 <TD ALIGN=CENTER BGCOLOR=#bbffbb>
         <FONT COLOR=RED><TT> F152a (CH3CHF2) <TD>
    <TD> <TH COLSPAN=3 ALIGN=RIGHT VALIGN=BOTTOM> Key
    <TD COLSPAN=9 VALIGN=BOTTOM> Standard HITRAN line molecules
<TR><TD><TD><TD><TD><TD><TD><TD>
    <TD COLSPAN=9 BGCOLOR=#FFFFAA> HITRAN line Molecules also represented 
as cross-sections
<TR><TD><TD><TD><TD><TD><TD><TD>
   <TD COLSPAN=9 BGCOLOR=#FFBBBB> RFM-specific line molecules
<TR><TD><TD><TD><TD><TD><TD><TD>
   <TD COLSPAN=9 BGCOLOR=#BBFFFF> Extinction cross-section [km<sup>-1</sup>] 
(RFM-specific IDs)
<TR><TD><TD><TD><TD><TD><TD><TD>
   <TD COLSPAN=9 BGCOLOR=#BBFFBB> Molecular cross-section
         [cm<sup>2</sup>/molec] (RFM-specific IDs)
<TR><TD><TD><TD><TD><TD><TD><TD>
   <TD COLSPAN=9 BGCOLOR=#BBBBFF> Dummy names for extra cross-section
      molecules (RFM-specific IDs)
</TABLE>

See <a href=./sum/rfm_gaslist.html>User's Manual</a> for more information.

<hr>
<a href=http://www.atm.ox.ac.uk/>Atmospheric, Oceanic and Planetary Physics
Home Page</a>
</BODY>
</HTML>


v"<1e=