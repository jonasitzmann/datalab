<HTML>
<HEAD>
<TITLE> MORSE Output Files</TITLE>
<LINK TYPE="text/css" REL="stylesheet" HREF="morse.css">
</HEAD>
<BODY>
<H1 class=page>MORSE Output Files</h1>
<H6>05OCT05</H6>
<font color=maroon>Differences from <a href=./v2/outputs.html>MORSE v2</a>
 in maroon</font>
<HR>
When <B>MORSE</B> is run successfully, 4 output files are <i>always</i> 
generated, plus a number of optional outputs which can be selected by
various combinations of <B><a href=driver.html#flg>Flags</a></b> in 
the <A href=driver.html><b>driver table</b></a>.

<P>

<TABLE ALIGN=center>
<CAPTION><B>MORSE Output Files</B></CAPTION>
<THEAD>
<TH CLASS=M COLSPAN=2>Mandatory outputs<TH CLASS=M> Updated
<TBODY>
<TR> <TD><A href=#log><B>morse.log</b></a>
     <TD> Log file <TD> Every Iteration
<TR> <TD><a href=#rtv><B>morse.rtv</b></a>
     <TD> Retrieved state vector <TD> Every Microwindow
<TR> <TD><a href=#atm><B>morse.atm</b></a>
     <TD> Retrieved atmosphere <TD> Every Microwindow
<TR> <TD><a href=#swp><B>morse.swp</b></a>
     <TD> Sweep information <TD> Every Microwindow <TD> 
<font color=maroon>Added in <a
     href=updates.html#v3>MORSE v3</a> </font>
<TR> <TH CLASS=O COLSPAN=2>Optional outputs 
<TH CLASS=O> Updated <TH CLASS=O> Reqd Flag(s) 
<TR> <TD><a href=#acv><B>morse.acv</b></a> 
     <TD> A Priori Covariance 
     <TD> At Start <TD align=center> <B>APR</B> + <B>COV</B>
<TR> <TD><a href=#apr><B>morse.apr</b></a> 
     <TD> A Priori state vector <TD> At Start <TD align=center> <B>APR</B> 
<TR> <TD><a href=#cov><B>morse.cov</b></a> 
     <TD> Retrieval Covariance 
     <TD> Every Microwindow <TD align=center> <B>COV</B> 
<TR> <TD><a href=#dia><B>morse.dia</b></a> 
     <TD> Diagnostics <TD> Every Iteration <TD align=center> <B>DIA</B> 
<TR> <TD><a href=#res><B>morse.res</b></a> 
     <TD> Residual Spectra <TD> Every Microwindow <TD align=center> <B>RES</B> 
</TABLE>
<P>
<DL>
<DT><B>Notes</b>
<OL> 
<LI> The <B>MWO</B> Flag can be used to save the 
outputs after each microwindow as separate files which have the same filenames
as the normal outputs but with '<b>_MW</b>[nn]' appended, where [nn]
is the
microwindow sequence number.  This is the
only way of examining the continuum retrieval (which is fitted separately
for each microwindow).
<LI> Output file names and/or directory (apart from <b>morse.log</b>)
    can be altered using the optional 
    <a href=driver.html#out><b>*OUT</b></a> section of the driver table.
</ol>
</DL>

<P>
<a name=common>
<H2 class=bar>Common File Headers</H2>

Apart from <b><a href=#log>morse.log</a></b> and 
<b><a href=#dia>morse.dia</a></b>, all MORSE output files have a 
common header consisting of 3 records, each of which starts with
a '<b>!</b>' character so that they are all regarded as 'comment records'
when used as input files.

<DL>
<P>
<DT><B>Format</b>
<DD> 3 records of 80 characters
<DD> <TABLE CLASS=rec>
    <TR><TD>!<B>FILE_TYPE</B> generated by MORSE v.<B>VERSID</B>
    <TR><TD>!<B>COMMENT</B> <TD BGCOLOR=WHITE>
    <TR><TD>! YMD=<B>YMD</B> HMS=<B>HMS</B> LAT=<B>LAT</B> LON=<B>LON</B> LST=<B>LST</B> SZA=<B>SZA</B>
    </TABLE>

<P>
<DD><TABLE CLASS=fld>
   <TR><TH>Field<TH>Type<TH>Description
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B>FILE_TYPE</B></FONT> 
       <TD> C*(*) 
       <TD> Describes the output file
       <TD> eg 'Retrieved Profiles'
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B>VERSID</B></FONT> 
       <TD> C*11 
       <TD> <a href=updates.html>MORSE version</a> identifier 
       <TD> eg '28OCT04'
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> COMMENT </B></FONT> 
       <TD ALIGN=CENTER> C*79
       <TD>  Comment 
       <TD> From <a href=driver.html#hdr><B>*HDR</b></a> section
       <TD> 
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> YMD </B></FONT> 
       <TD ALIGN=CENTER> I8.8
       <TD> Date of the scan [yyyymmdd]
       <TD> eg '20020724' (=24th July, 2002) 
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> HMS </B></FONT>
       <TD ALIGN=CENTER> I6.6 
       <TD> Time of the scan [hhmmss]
       <TD> eg '113640'> (=11:36:40 am)
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> LAT </B></FONT>
       <TD ALIGN=CENTER> F8.4 
       <TD> Latitude in [deg N]
       <TD> eg '49.0245'
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> LON </B></FONT>
       <TD ALIGN=CENTER> F9.4 
       <TD> Longitude in [deg E]
       <TD> eg '-20.6655'
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> LST </B></FONT>
       <TD ALIGN=CENTER> F7.4 
       <TD> Local Solar Time [h]
       <TD> eg '10.1200'
   <TR><TD ALIGN=RIGHT> <FONT COLOR=RED><B> SZA </B></FONT>
       <TD ALIGN=CENTER> F8.4 
       <TD> Solar Zenith Angle [deg]
       <TD> eg '36.8797'
   </TABLE>
<P>
<DT><B>Notes</b>
  <OL> 
  <LI> The time and location information for the scan is based on that of
        the central sweep in the scan 
  <LI> In the <b><a href=#res>morse.res</a></b> file header
       the '<b>!</b>' character at the start of each record is replaced 
       by '<B>#</b>'.
  </ol>
</DL>

<P>
The rest of this document describes each type of output file in more detail.

<a name=log>
<h2 class=m>morse.log (mandatory)</h2>

<P>
<DL>
<DT><B>Description</b> 
<DD>General file for logging all status/progress messages.

<P>
<DT><B>Format</b>
<DD>     Text records of any of the following kind
      <TABLE CLASS=REC>
      <TH COLSPAN=2 align=left BGCOLOR=WHITE>Identifying 
message category and subroutine 
      <TR><TD>R-MORSE: ...
          <TD BGCOLOR=WHITE> Start and successful completion 
      <TR><TD>I-[SUB]: ...
          <TD BGCOLOR=WHITE> Information from subroutine [SUB]
      <TR><TD>W-[SUB]: ...
          <TD BGCOLOR=WHITE> Warning from subroutine [SUB]
      <TR><TD>F-[SUB]: ...
          <TD BGCOLOR=WHITE> Fatal Error from subroutine [SUB]
      <TR><TH COLSPAN=2 align=left  BGCOLOR=WHITE>Identifying driver table section being read
      <TR><TD>*[ABC]
          <TD BGCOLOR=WHITE> Reading <a href=driver.html>Driver Table</a> 
               section <b>*[ABC]</b>
      <TR><TH COLSPAN=2 align=left BGCOLOR=WHITE>Next record after <b>I-OPNFIL: ...</b> 
      <TR><TD>! [comment]</font>
          <TD BGCOLOR=WHITE> 1st record of file just opened (usually a comment)
      <TR><TH COLSPAN=2 align=left  BGCOLOR=WHITE>Next 2 records after <b>I-LUTFIL: ...</b> 
      <TR><TD>[dd-mmm-yyy] [hh.mm.ss.000000]
          <TD BGCOLOR=WHITE> Time stamp of LUT file just opened
      <TR><TD># [comment] </font>
          <TD BGCOLOR=WHITE> Comment record for LUT
      </TABLE>

<P>
<DT><B>Notes</b>
  <OL>
  <LI> The first record will always be:
      <blockquote><div class=filbox>
       R-MORSE: Running MORSE v<B>VERSID</B>
      </div></blockquote>
      where <B>VERSID</b> identifies the <a href=updates.html>MORSE
      version</a>  being run (C*11 variable <b>VIDHDR</b> in file 
      <b>hdrcom.inc</b>, Set in main program module <b>morse.for</b>).
  <LI> For a successfully completed run the last message will be
      <blockquote><div class=filbox>
       R-MORSE: Successful completion
      </div></blockquote>

  </ol>
<P>
<DT><B>Examples</b>
  <DD> <a href=morse_pt.log><B>morse.log</b></a> from pT retrieval
       (generated with 
        driver table <b><a href=morse_pt.drv>morse.drv</a></b>)
  <DD> <a href=morse_h2o.log><B>morse.log</b></a> from H2O retrieval
       (generated with 
        driver table <b><a href=morse_h2o.drv>morse.drv</a></b>)
</dl>

<a name=rtv>
<h2 class=m>morse.rtv (mandatory)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Retrieved State Vector & SD

<P>
<DT><B>Format</b>
<DD> RFM <a href=http://www.atm.ox.ac.uk/RFM/sum/atmfil.html><B>.atm</b></a>
      file format

<P>
<DT><B>Notes</b>
   <OL>
   <LI> If more than one gas/species is retrieved, 
        these are written in the same
        order as they are placed in the 
        <a href=driver.html#rtv><B>*RTV</b></a>
        section of the driver table.
   <LI> For each retrieved profile (eg <b>H2O</b>) there immediately follows
       a profile of SD values (eg <b>H2O_SD</B>) containing the square root
       of the diagonal elements of the retrieval covariance converted to the
      same units as the profile.
   <LI> Profiles of Sweep# and Cloud Detection (1=cloud, 0=cloud free) are
        written only for retrievals on the tangent point grid (these are, in
        any case, always written in the <a href=#swp><b>.swp</b></a> file).
   <LI> If the <B>MWO</B> Flag is enabled then the retrieved continuum 
      (<B>*CTM</B>) and SD (<B>*CTM_SD</B>) profiles are to the individual
        <B>morse.rtv_MW</b>[nn] files.
   <LI> <font color=maroon>In MORSE v3 diagnostics are written to the 
        <a href=#swp><b>.swp</b></a> file.</font>
   </ol>
<P>
<DT><B>Examples</b>
   <DD> <a href=morse_pt.rtv><b>morse_pt.rtv</b></a> from pT retrieval
   <DD> <a href=morse_h2o.rtv><b>morse_h2o.rtv</b></a> from H2O retrieval
</DL>

<a name=atm>
<h2 class=m>morse.atm (mandatory)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Retrieved Atmosphere
<P>
<DT><B>Format</b>
<DD> RFM <a href=http://www.atm.ox.ac.uk/RFM/sum.html#atmfil> 
     <B>.atm</b></a> file format

<P>
<DT><B>Notes</b>
   <OL>
  <LI> The same species profiles are written as in the <a
          href=#rtv><b>.rtv</b></a> output except that 
       profiles extend for full atmosphere used in internal forward model
          (so included fixed as well as retrieved profile levels), and
         no SD profiles are included.
   <LI> The <b>morse.atm</b> files are recommended for passing
       the information from one retrieval into another retrieval from the
        same scan via the <a href=driver.html#l2p><B>*L2P</b></a> section
        of the driver table.
   <LI> If the <B>MWO</B> Flag is enabled then the retrieved continuum 
      (<B>*CTM</B>) profiles are to the individual
        <B>morse.atm_MW</b>[nn] files.
   </ol>
<P>
<DT><B>Examples</b>
   <DD> <a href=morse_pt.atm><b>morse_pt.atm</b></a> from pT retrieval
   <DD> <a href=morse_h2o.atm><b>morse_h2o.atm</b></a> from H2O retrieval
</DL>

<a name=swp>
<h2 class=m>morse.swp (mandatory)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Sweep(=spectrum) Diagnostics
<P>

<DT><B>Format</b>
<DD> RFM <a href=http://www.atm.ox.ac.uk/RFM/sum.html#atmfil> 
     <B>.atm</b></a> file format, except that first profile is Sweep Index
     rather than altitude and usually in descending altitude order
<DD> <TABLE CLASS=REC>
     <TR><TD><B>!CFH#1 </B> <TD BGCOLOR=WHITE> Common File Header
     <TR><TD><B>!CFH#2 </B> <TD BGCOLOR=WHITE> Common File Header
     <TR><TD><B>!CFH#3 </B> <TD BGCOLOR=WHITE> Common File Header 
     <TR><TD><B> NSWP </B> ! Number of Sweeps
     <TR><TD><B>*PROF</B>  <TD BGCOLOR=WHITE> Start repeat for profiles
     <TR><TD><B>PRFVAL</B>(ISWP) <TD BGCOLOR=WHITE> Repeat for ISWP=1, NSWP
     <TR><TD>              <TD BGCOLOR=WHITE> End repeat for profiles
     <TR><TD>*END
     </TABLE> 
    
<DD> <TABLE CLASS=FLD>
     <TR><TH> Field <TH> Type <TH> Description <TH> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>CFH#</B>n</FONT>
         <TD ALIGN=CENTER> C*80 
         <TD> 3 Common File Header Records
         <TD> See <a href=#common>CFH description</a>
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>NSWP</B></FONT> 
         <TD ALIGN=CENTER> I*4 
         <TD> No. of sweeps in L1C file
         <TD> eg '17'
     <TR><TH COLSPAN=3>Then the following *PROF/PRFVAL arrays
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*SWEEP</B></FONT>
         <TD ALIGN=CENTER> I*4
         <TD> Sweep Index 
         <TD> From <A href=http://www.atm.ox.ac.uk/group/mipas/L1C/>L1C file</a> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*HGT_NOM</B></FONT>
         <TD ALIGN=CENTER> R*4
         <TD> Nominal Altitude [km] 
         <TD> From <A href=http://www.atm.ox.ac.uk/group/mipas/L1C/>L1C file</a> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*HGT_LV1</B></FONT>
         <TD ALIGN=CENTER> R*4
         <TD> L1B 'Engineering' Altitude [km] 
         <TD> From <A href=http://www.atm.ox.ac.uk/group/mipas/L1C/>L1C file</a> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*HGT_RTV</B></FONT>
         <TD ALIGN=CENTER> R*4
         <TD> L2 Retrieved Altitude [km] 
         <TD> From <a href=inputs.html#swp>input .swp file</a>
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*CLOUD</B></FONT>
         <TD ALIGN=CENTER> I*4
         <TD> Cloud Flags 
         <TD> 1=Cloud, 0=No Cloud
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*NMIC</B></FONT>
         <TD ALIGN=CENTER> I*4
         <TD> No.Microwindows Used
         <TD> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*NOTCNV</B></FONT>
         <TD ALIGN=CENTER> I*4
         <TD> No.Microwindows not converged
         <TD> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*AVGITR</B></FONT>
         <TD ALIGN=CENTER> R*4
         <TD> Average No.Iterations per MW
         <TD> 
     <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>*AVGCSQ</B></FONT>
         <TD ALIGN=CENTER> R*4
         <TD> Average Chi-Sq per MW
         <TD> 
     </TABLE>
<P>
<DT><B>Notes</b>
   <OL>
   <LI> <b>.swp</b> files contain at least 2 altitude grids derived from the 
       L1C file and usually the <B>*HGT_RTV</B> grid which is generated in the
      output of the pT retrieval <B>.swp</B> file and input to subsequent
      retrievals in the <a href=inputs.html><B>*L1C</B></A> section.
   <LI> The <B>*CLOUD</B> array is generated whether or not the <B>CLD</B> Flag
       is used (ie without the <B>CLD</B> Flag microwindows
       may still be used for sweeps which are indicated here as cloudy).
   <LI> The <B>MWO</B> Flag generates files <b>morse.swp_MW</b>[nn] containing
       only the results for a single microwindow, hence <B>*NMIC</B> values are
       all 1 or 0 and <B>*AVGITR</B> and <B>AVGCSQ</B> refer to single
       retrievals (so not really  averages).
   </ol>
<P>
<DT><B>Examples</b>
   <DD> <a href=morse_pt.swp><b>morse_pt.swp</b></a> from pT retrieval
   <DD> <a href=morse_h2o.swp><b>morse_h2o.swp</b></a> from H2O retrieval
</DL>

<a name=acv>
<h2 class=o>morse.acv (optional)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> A Priori Covariance
<DD> Output if both the <B>APR</b> and <B>COV</b> flags are included in
the <a href=driver.html#flg><B>*FLG</b></a> section
of the driver table.
<P>
<DT><B>Format</b>
<DD> Same as <b><a href=#cov>morse.cov</a></b>
<P>
<DT><B>Notes</b>
   <OL>
   <LI> The file <b>morse.acv</b> contains the <i>a priori</i> covariance at
      the start of the retrieval,
      eg with 100% uncertainties for VMR (converted to [ln(VMR)]^2)
      unless
      modified via the <a href=driver.html#asd><B>*ASD</b></a> section  of the
     driver table. This is written at the start of the first retrieval
      and not changed. Continuum and Offset terms are not included.
   <LI> If the <B>MWO</B> Flag is enabled the files 
      <B>morse.acv_MW</b>[nn] contain the 
     <i>a priori</i> covariance at the start of each microwindow retrieval,
      including any continuum and offset components.
   </ol>
<P>
<DT><B>Example</b>
<DD> <a href=morse.acv><B>morse.acv</b></a>
</dl>


<a name=apr>
<h2 class=o>morse.apr (optional)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> A Priori State Vector
<DD> Output if the <B>APR</b> flag is included in
the <a href=driver.html#flg><B>*FLG</b></a> section
of the driver table
<P>
<DT><B>Format</b>
<DD> RFM <a href=http://www.atm.ox.ac.uk/RFM/sum.html#atmfil><B>.atm</b></a> 
      file format

<P>
<DT><B>Notes</b>
   <OL>
   <LI> Contains the same profiles/sequence as in the 
     <B><a href=#rtv>morse.rtv</a></b>
     file, except referring to <I>a priori</I> profiles at the start of
     the retrieval, as read in from the 
     <a href=driver.html#cli><B>*CLI</B></a> and
     <a href=driver.html#l2p><B>*L2P</B></a> sections  of the 
     driver table.
   </ol>
<P>
<DT><B>Examples</b>
<DD> <a href=morse.apr><B>morse.apr</b></a>
</dl>

<a name=cov>
<h2 class=o>morse.cov (optional)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Retrieval Covariance
<DD> Output if the <B>COV</b> flag is included in
the <a href=driver.html#flg><B>*FLG</b></a> section
of the driver table
<P>
<DT><B>Format</b>
<DD> MORSE matrix file format
<TABLE CLASS=REC>
<TR><TD><B>!CFH#1 </B> <TD BGCOLOR=WHITE> Common File Header
<TR><TD><B>!CFH#2 </B> <TD BGCOLOR=WHITE> Common File Header
<TR><TD><B>!CFH#3 </B> <TD BGCOLOR=WHITE> Common File Header 
<TR><TD><B> N M </B>
<TR><TD><B>SX</B>(i,j)   <TD BGCOLOR=WHITE>  repeat ((for i=1,n), j=1,m)
</TABLE>

<P>
<DD>
<TABLE CLASS=FLD>
<TH> Field <TH> Type <TH> Description <TH> 
<TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>CFH#</B>n</FONT>
    <TD ALIGN=CENTER> C*80 
    <TD> 3 Common File Header Records
    <TD> See <a href=#common>CFH description</a>
<TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>N</B></FONT> 
    <TD ALIGN=CENTER> I*4 
    <TD> First dimension of matrix 
    <TD> eg '36'
<TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>M</B></FONT> 
    <TD ALIGN=CENTER> I*4 
    <TD> Second dimension of matrix 
    <TD> eg '36'
<TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>SX</B>(i,j)</FONT>
    <TD ALIGN=CENTER> R*8 
    <TD> Element i,j of the 
       Covariance Matrix 
    <TD> eg '0.151308903009384'
</TABLE>

<P>
<DT><B>Notes</b>
   <OL>
  <LI> The ordering of elements within this covariance matches that
       of the elements in <a href=#rtv><b>morse.rtv</b></a> and
       excludes microwindow-dependent parameters
       such as continuum and offset.
  <LI> Since covariance matrices are always square, <B>M=N</B>, but
        both dimensions are required  as this is a general matrix file format 
   <LI> If the <B>MWO</B> Flag is enabled the files <B>morse.cov_MW[nn]</b> 
      matches
      the elements of <a href=#rtv><B>morse.rtv_MW</b>[nn]</a>, including
        any continuum and offset components.
   <LI> The retrieval covariance file can be used directly as the
      <a href=inputs.html#acv>A Priori Covariance input</a> to
       the next scan retrieval via the <a href=driver.html#acv><b>*ACV</b></a>
       section of the driver table.
   </ol>
<P>
<DT><B>Examples</b>
<DD> <a href=morse.cov><B>morse.cov</b></a> (corresponds to <a
href=morse_pt.rtv><b>morse_pt.rtv</b></a>)
<DD> <a href=morse.cov_MW01><B>morse.cov_MW01</b></a> (corresponds to
<a href=morse.rtv_MW01><b>morse.rtv_MW01</b></a>)
</dl>

<a name=dia>
<h2 class=o>morse.dia (optional)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Diagnostics file. 
<DD> Output if the <B>DIA</b> flag is included in
the <a href=driver.html#flg><B>*FLG</b></a> section
of the driver table
<P>
<DT><B>Format</b>
<DD> Not yet defined!
<DD> At the moment a bit of a mess with all sorts of possibly useful
      information output each iteration by subroutine <b>wrtdia.for</b>
<P>
<DT><B>Notes</b>
   <OL>
   <LI> IDL procedure <a href=inpdia.pro><b>inpdia.pro</b></a> 
       may be useful in reading
        the MORSE diagnostics file into a structure.
   </ol>
<P>
<DT><B>Example</b>
   <DD> <A href=morse.dia><b>morse.dia</b></a>
</DL>

<a name=res>
<h2 class=o>morse.res (optional)</h2>
<P>
<DL>
<DT><B>Description</b>
<DD> Residual Spectra
<DD> Output if the <B>RES</b> flag is included in
the <a href=driver.html#flg><B>*FLG</b></a> section
of the driver table
<P>
<P>
<DT><B>Format</b>
<DD> 
  <TABLE CLASS=REC>
  <TR><TD><B>!CFH#1 </B> <TD BGCOLOR=WHITE> Common File Header
  <TR><TD><B>!CFH#2 </B> <TD BGCOLOR=WHITE> Common File Header
  <TR><TD><B>!CFH#3 </B> <TD BGCOLOR=WHITE> Common File Header 
  <TR><TD>#OM=??? DN=<B>DN</B> AD=?  <TD BGCOLOR=WHITE> Day/Night
  <TR><TD><b>MWLABEL  NPTS  NOMALT NAVG</B> 
      <TD BGCOLOR=WHITE> Start Repeat for each MWLABEL,NOMALT
  <TR><TD><B>RES</B>(i) <TD BGCOLOR=WHITE> Repeat for i=1,NPTS
  <TR><TD><TD BGCOLOR=WHITE> End Repeat for MWLABEL,NOMALT
  </TABLE>
<DD>
  <TABLE CLASS=FLD> 
  <TR><TH>Field<TH>Type<TH>Description
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>CFH#</B>n</FONT>
      <TD ALIGN=CENTER> C*80 
      <TD> 3 Common File Header Records
      <TD> See <a href=#common>CFH description</a>
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B> DN </B></FONT>
      <TD ALIGN=CENTER> C*1
      <TD> 'D'=Daytime, 'N'=Nighttime
      <TD> 
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B> MWLABEL </B></FONT>
      <TD ALIGN=CENTER> C*8 
      <TD> Microwindow label
      <TD> eg 'PT__0001'
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B> NPTS </B></FONT>
      <TD ALIGN=CENTER> I*4 
      <TD> No. of spectral points in MW
      <TD> eg '121'
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B> NOMALT </B></FONT> 
      <TD ALIGN=CENTER> R*4 
      <TD> Nominal Altitude [km]
      <TD> eg '68.00000'
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B> NAVG </B></FONT> 
      <TD ALIGN=CENTER> I*4
      <TD> No. residual spectra averaged 
      <TD> always 1
  <TR><TD ALIGN=RIGHT><FONT COLOR=RED><B>RES</B>(i)</FONT> 
      <TD ALIGN=CENTER> R*4
      <TD> Value of the residual at spectral point i
      <TD> 
  </TABLE>
<P>
<DT><B>Notes</b>
   <OL>
   <LI> Residuals are defined as (measurement-forward model), written in
        <b>swpres.for</b>
   <LI> MORSE generates residuals after each microwindow/sweep is processed,
        so these are not 'true' residuals since the retrieved profile
      (and therefore forward model radiance) continues to change after the
       residuals are output.
   <LI> '#OM=???' etc record: this record is for compatibility with the 
       ESA residuals, and 
        basically states that the occupation matrix, and
        ascending/descending node of the orbit are undefined for these
        residuals. However, the Day/Night is determined by the solar zenith
        angle (&gt;90 = nighttime, otherwise daytime).
   <LI> The format is the same as the residual files extracted from ESA
        data by the IDL program <B>l2proc_res.pro</b>
   </ol>
<P>
<DT><B>Example</b>
<DD> <a href=morse.res><B>morse.res</b></a> 
</dl>

<HR>
<a href=index.html>Back to MORSE Index</a>
</BODY>
</HTML>


bR"nl=/